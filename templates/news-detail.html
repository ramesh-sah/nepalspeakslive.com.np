{% extends 'base.html' %}
{% block content %}

<div class="w-full bg-white text-gray-900 font-['Roboto']">

    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="w-full mx-auto px-4 py-4 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-gray-900 tracking-tight">Everest News</h1>
            <a href="{% url 'news' %}" class="text-blue-600 font-semibold hover:underline text-sm">Back to News</a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="w-full max-w-full mx-auto px-4 py-10 grid grid-cols-1 lg:grid-cols-3 gap-10">

        <!-- Article -->
        <article class="bg-white rounded-xl shadow-md overflow-hidden lg:col-span-2">

            {% if news_item.featured_image %}
            <div class="relative">
                <img src="{{ news_item.featured_image.url }}" 
                     alt="{{ news_item.title }}" 
                     class="w-full h-[500px] object-cover brightness-95 hover:brightness-100 transition duration-300">
                {% if news_item.is_breaking %}
                <span class="absolute top-4 left-4 bg-red-600 text-white px-3 py-1 text-sm font-bold rounded-full shadow">BREAKING</span>
                {% elif news_item.is_trending %}
                <span class="absolute top-4 left-4 bg-yellow-500 text-white px-3 py-1 text-sm font-bold rounded-full shadow">TRENDING</span>
                {% endif %}
            </div>
            {% endif %}

            <div class="p-6">
                <h2 class="text-2xl font-bold mb-4 leading-snug text-gray-900">{{ news_item.title }}</h2>

                <div class="flex flex-wrap items-center text-gray-500 mb-5 space-x-4 text-sm">
                    {% if news_item.author %}<span>Author: {{ news_item.author }}</span>{% endif %}
                    {% if category %}<span>Category: {{ category.name }}</span>{% endif %}
                    <span>{{ news_item.published_date|date:"F j, Y" }}</span>
                    {% if news_item.location %}<span>{{ news_item.location }}</span>{% endif %}
                </div>

                <!-- Top Social Share Bar -->
                <div class="w-full flex flex-wrap justify-start items-center gap-4 py-2">
                    <button onclick="share('facebook')" title="Share on Facebook" class="hover:scale-110 transition">
                        <i class="fa-brands fa-facebook-f text-[#3b5998] text-[18px]"></i>
                    </button>
                    <button onclick="share('twitter')" title="Share on X (Twitter)" class="hover:scale-110 transition">
                        <i class="fa-brands fa-twitter text-[#1DA1F2] text-[18px]"></i>
                    </button>
                    <button onclick="share('linkedin')" title="Share on LinkedIn" class="hover:scale-110 transition">
                        <i class="fa-brands fa-linkedin-in text-[#0077B5] text-[18px]"></i>
                    </button>
                    <button onclick="share('whatsapp')" title="Share on WhatsApp" class="hover:scale-110 transition">
                        <i class="fa-brands fa-whatsapp text-[#25D366] text-[18px]"></i>
                    </button>
                    <button onclick="share('telegram')" title="Share on Telegram" class="hover:scale-110 transition">
                        <i class="fa-brands fa-telegram-plane text-[#0088cc] text-[18px]"></i>
                    </button>
                    <button onclick="share('instagram')" title="Share on Instagram" class="hover:scale-110 transition">
                        <i class="fa-brands fa-instagram text-[#E1306C] text-[18px]"></i>
                    </button>
                    <button onclick="share('tiktok')" title="Share on TikTok" class="hover:scale-110 transition">
                        <i class="fa-brands fa-tiktok text-black text-[18px]"></i>
                    </button>
                    <button onclick="share('medium')" title="Share on Medium" class="hover:scale-110 transition">
                        <i class="fa-brands fa-medium text-black text-[18px]"></i>
                    </button>
                    <button onclick="share('pinterest')" title="Share on Pinterest" class="hover:scale-110 transition">
                        <i class="fa-brands fa-pinterest-p text-[#BD081C] text-[18px]"></i>
                    </button>
                    <button onclick="share('reddit')" title="Share on Reddit" class="hover:scale-110 transition">
                        <i class="fa-brands fa-reddit-alien text-[#FF4500] text-[18px]"></i>
                    </button>
                    <button onclick="share('tumblr')" title="Share on Tumblr" class="hover:scale-110 transition">
                        <i class="fa-brands fa-tumblr text-[#35465C] text-[18px]"></i>
                    </button>
                    <button onclick="share('copy')" title="Copy link" class="hover:scale-110 transition">
                        <i class="fa-solid fa-link text-gray-700 text-[18px]"></i>
                    </button>
                </div>

                {% if news_item.summary %}
                <p class="text-gray-700 mb-6 leading-relaxed font-bold">{{ news_item.summary }}</p>
                {% endif %}

                <div class="prose prose-base max-w-none text-gray-800 leading-relaxed">
                    {{ news_item.content|safe }}
                </div>

                <!-- Extra Info Section -->
                <div class="bg-gray-50 rounded-lg p-4 mt-6 space-y-1 border border-gray-100 text-gray-700 text-sm">
                    {% if news_item.weather_update %}<p><strong>Weather Update:</strong> {{ news_item.weather_update }}</p>{% endif %}
                    {% if news_item.peak_altitude %}<p><strong>Peak Altitude:</strong> {{ news_item.peak_altitude }} m</p>{% endif %}
                    {% if news_item.risk_level %}<p><strong>Risk Level:</strong> {{ news_item.risk_level }}</p>{% endif %}
                    {% if news_item.expedition_info %}<p><strong>Expedition Info:</strong> {{ news_item.expedition_info }}</p>{% endif %}
                </div>

                <!-- Tags -->
                {% if tags %}
                <div class="flex flex-wrap gap-2 mt-6">
                    {% for tag in tags %}
                    <span class="bg-blue-100 text-blue-700 text-sm font-semibold px-3 py-1 rounded-full">{{ tag }}</span>
                    {% endfor %}
                </div>
                {% endif %}
            </div>

            <!-- Gallery -->
            {% if images %}
            <div class="p-6 border-t">
                <h3 class="text-xl font-bold mb-4">Photo Gallery</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    {% for image in images %}
                    <div class="overflow-hidden rounded-lg shadow-sm hover:shadow-md transition">
                        <img src="{{ image.image.url }}" alt="{{ image.caption }}" class="w-full h-80 object-cover hover:scale-105 transition-transform duration-300">
                        {% if image.caption %}<p class="text-gray-600 text-sm mt-1">{{ image.caption }}</p>{% endif %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Videos -->
            {% if videos %}
            <div class="p-6 border-t">
                <h3 class="text-xl font-bold mb-4">Videos</h3>
                <div class="space-y-6">
                    {% for video in videos %}
                    <div class="rounded-lg overflow-hidden shadow-md hover:shadow-lg transition">
                        <video controls class="w-full h-96 rounded-lg">
                            <source src="{{ video.video.url }}" type="video/mp4">
                            Your browser does not support video playback.
                        </video>
                        {% if video.caption %}<p class="text-gray-600 text-sm mt-2">{{ video.caption }}</p>{% endif %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Social Media Section -->
            <div class="flex flex-col sm:flex-row items-center justify-between p-6 border-t gap-4">
                <span class="text-sm text-gray-600">Stay connected with Mount Everest updates on social media</span>
                <div class="flex gap-6 text-black flex-wrap">
                    <a href="https://wa.me/9779705970563" target="_blank" rel="noopener" class="transition transform hover:scale-110">
                        <i class="fa-brands fa-whatsapp text-[#25D366] text-[20px]"></i>
                    </a>
                    <a href="https://www.linkedin.com/company/mount-everest-summit/" target="_blank" rel="noopener" class="transition transform hover:scale-110">
                        <i class="fa-brands fa-linkedin-in text-[#0077B5] text-[20px]"></i>
                    </a>
                    <a href="https://www.facebook.com/share/1CRDtdtMGS/" target="_blank" rel="noopener" class="transition transform hover:scale-110">
                        <i class="fa-brands fa-facebook-f text-[#3b5998] text-[20px]"></i>
                    </a>
                    <a href="https://www.instagram.com/mounteverest.summit/" target="_blank" rel="noopener" class="transition transform hover:scale-110">
                        <i class="fa-brands fa-instagram text-[#E1306C] text-[20px]"></i>
                    </a>
                    <a href="https://www.youtube.com/@mounteverestsummit" target="_blank" rel="noopener" class="transition transform hover:scale-110">
                        <i class="fa-brands fa-youtube text-[#FF0000] text-[20px]"></i>
                    </a>
                    <a href="https://www.tiktok.com/@mt.everestsummit" target="_blank" rel="noopener" class="transition transform hover:scale-110">
                        <i class="fa-brands fa-tiktok text-black text-[20px]"></i>
                    </a>
                    <a href="https://medium.com/@chintuvikas0" target="_blank" rel="noopener" class="transition transform hover:scale-110">
                        <i class="fa-brands fa-medium text-black text-[20px]"></i>
                    </a>
                    <a href="https://twitter.com/mount_everest" target="_blank" rel="noopener" class="transition transform hover:scale-110">
                        <i class="fa-brands fa-twitter text-[#1DA1F2] text-[20px]"></i>
                    </a>
                </div>
            </div>

        </article>

        <!-- Sidebar -->
        <aside class="space-y-8">
            <!-- Related Stories -->
            <section class="bg-white rounded-xl shadow-md overflow-hidden">
                <div class="p-6">
                    <h3 class="text-xl font-bold mb-4 border-b pb-2">Related Stories</h3>
                    <div class="divide-y divide-gray-100">
                        {% for item in related_news %}
                        <a href="{% url 'news-detail' item.slug %}" class="flex items-start space-x-4 py-4 hover:bg-gray-50 transition">
                            {% if item.featured_image %}
                            <img src="{{ item.featured_image.url }}" class="w-32 h-32 object-cover rounded-md shadow-sm" alt="{{ item.title }}">
                            {% endif %}
                            <div class="flex-1">
                                <h4 class="text-gray-900 font-semibold line-clamp-2">{{ item.title }}</h4>
                                <p class="text-gray-600 text-sm line-clamp-2 mt-1">{{ item.summary|truncatewords:12 }}</p>
                                <p class="text-gray-400 text-xs mt-1">{{ item.published_date|date:"F j, Y" }}</p>
                            </div>
                        </a>
                        {% empty %}
                        <p class="text-gray-500 py-2">No related stories available.</p>
                        {% endfor %}
                    </div>
                </div>
            </section>
        </aside>

    </main>
</div>

<!-- JS Share Function -->
<script>
function share(platform) {
    const url = "{{ request.build_absolute_uri }}";
    const title = "{{ news_item.title|escapejs }}";
    let shareUrl = "";

    switch(platform) {
        case 'facebook': shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`; break;
        case 'twitter': shareUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`; break;
        case 'linkedin': shareUrl = `https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(url)}&title=${encodeURIComponent(title)}`; break;
        case 'whatsapp': shareUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(title)}%20${encodeURIComponent(url)}`; break;
        case 'telegram': shareUrl = `https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`; break;
        case 'instagram': shareUrl = `https://www.instagram.com/?url=${encodeURIComponent(url)}`; break;
        case 'tiktok': shareUrl = `https://www.tiktok.com/share?url=${encodeURIComponent(url)}`; break;
        case 'medium': shareUrl = `https://medium.com/share?url=${encodeURIComponent(url)}&title=${encodeURIComponent(title)}`; break;
        case 'pinterest': shareUrl = `https://pinterest.com/pin/create/button/?url=${encodeURIComponent(url)}&description=${encodeURIComponent(title)}`; break;
        case 'reddit': shareUrl = `https://www.reddit.com/submit?url=${encodeURIComponent(url)}&title=${encodeURIComponent(title)}`; break;
        case 'tumblr': shareUrl = `https://www.tumblr.com/widgets/share/tool?canonicalUrl=${encodeURIComponent(url)}&title=${encodeURIComponent(title)}`; break;
        case 'copy': 
            navigator.clipboard.writeText(url);
            alert("ðŸ”— Link copied to clipboard!");
            return;
    }
    window.open(shareUrl, '_blank', 'noopener,noreferrer');
}
</script>

<!-- FontAwesome CDN -->
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

{% endblock %}
